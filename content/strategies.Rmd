---
exclude_jquery: false
#title: Strategies
menu: main
---

```{r, include=FALSE}
library(tidyverse)
library(readxl)
library(here)

knitr::opts_chunk$set(echo=FALSE, message = FALSE, warning = FALSE)

strategy_data <- read_excel(here("data", "content.xlsx"), sheet = "strategy-types") %>% 
  filter(include == "y")

strategy_types <- strategy_data$category %>% unique()

strategies_details <- read_excel(here("data", "content.xlsx"), sheet = "strategy-tools")
```



::: {.strategy-page}

::: {.row .top-matter}
::: {.col-sm-12}
This is the fantastic strategy page bla bla bla
:::

<!--
::: {.col-sm-3}
::: {.embed-responsive .embed-responsive-16by9}
<iframe class='embed-responsive-item featured-work-graphic' src='https://www.youtube.com/embed/GCOnzStHQcM' allowfullscreen></iframe>
:::
:::
-->

<!-- end row with top matter -->
:::

```{r, results='asis', echo=FALSE}
# function for generating information about detailed tools
generate_strategy_tools <- function(devices, title, illustration, description, embed_link){
  cat('<div class="row strategy-tool">')
  
  cat('<div class="col-sm-3">')
  cat(str_c('<h5 class="tool-title">', title, '</h5>'))
  cat(str_c('<p class="devices">', devices, '</p>'))
  cat("</div>")
  
  cat('<div class="col-sm-6">')
  cat(str_c("<p>", description, "</p>"))
  cat("</div>")
  
  cat('<div class="col-sm-3">')
  cat(str_c('<img src="', illustration, '" class="img-fluid"/>'))
  #cat('<div class="embed-responsive embed-responsive-16by9">')
  #cat(str_c('<iframe class="embed-responsive-item featured-work-graphic" src="', embed_link, '" allowfullscreen></iframe>'))
  #cat("</div>")
  cat("</div>")
  
  cat("</div>")
}

# function for generating overall types
generate_strategy_types <- function(strategy, illustration, illustration_position, description){
  clean_strategy <- janitor::make_clean_names(strategy)
  
  cat("<div class='col-sm-3 strategy-type'>")
  cat("<div class='card'>")
  cat(str_c('<img class="card-img-top" src="', illustration, '" style="object-position: ', illustration_position, ';" alt="Card image cap" data-toggle="collapse" data-target=".multi-collapse-', clean_strategy, '">'))
  cat("<div class='card-body'>")
  cat(str_c('<h5 class="card-title">', strategy, '</h5>'))
  cat(str_c('<p class="card-text">', description, '</p>'))
  cat(str_c('<button class="btn btn-primary" type="button" data-toggle="collapse" data-target=".multi-collapse-', clean_strategy, '">Tools/instructions</button>'))
  cat("</div>")
  cat("</div>")
  cat("</div>")
  
  cat(str_c('<div class="collapse multi-collapse-', clean_strategy, ' strategy-type-tools">'))
  
  strategies_details %>% 
    filter(actual_strategy == strategy) %>% 
    select(devices, title, illustration, description, embed_link) %>%
    pwalk(generate_strategy_tools)
  
  cat("</div>")
}

generate_strategy_views <- function(a_strategy_type){
  current_data <- strategy_data %>% 
    filter(category == a_strategy_type) %>% 
    select(strategy, illustration, illustration_position, description)
  
  cat("<div class='row strategy-class'>")
  cat("<div class='col-sm-12'>")
  cat(str_c("<h1>", a_strategy_type, "</h1>"))
  cat("</div>")
  
  pmap(current_data, generate_strategy_types)
  
  # close project row
  cat("</div>")
}

walk(strategy_types, generate_strategy_views)
```

<!-- end strategy page -->
:::
