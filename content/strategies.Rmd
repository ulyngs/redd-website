---
exclude_jquery: false
#title: Strategies
menu: main
---

```{r, include=FALSE}
library(tidyverse)
library(readxl)
library(here)

knitr::opts_chunk$set(echo=FALSE, message = FALSE, warning = FALSE)

strategy_data <- read_excel(here("data", "content.xlsx"), sheet = "strategy-types") %>% 
  filter(include == "y")

strategy_types <- strategy_data$category %>% unique()

strategies_details <- read_excel(here("data", "content.xlsx"), sheet = "strategy-tools")
```



::: {.strategy-page}

::: {.row .top-matter}
::: {.col-sm-12}
This is the fantastic strategy page bla bla bla
:::
:::


::: {.row}
::: {.col-sm-2}
<nav id="toc" data-toggle="toc" class="sticky-top"></nav>
:::

::: {.col-sm-10}

::: {.row .tool-filters}
::: {.col-sm-2}
<div>
Mac: 
<input type="checkbox" onclick="toggleMac()" style="margin:0;" checked="checked">
<br>
PC:
<input type="checkbox" onclick="togglePC()" style="margin:0;" checked="checked">
</div>
:::

::: {.col-sm-2}
<div>
Android: 
<input type="checkbox" onclick="toggleAndroid()" style="margin:0;" checked="checked">
<br>
iPhone / iPad:
<input type="checkbox" onclick="toggleIOS()" style="margin:0;" checked="checked">
</div>
:::

::: {.col-sm-2}
<div>
Chrome: 
<input type="checkbox" onclick="toggleChrome()" style="margin:0;" checked="checked">
<br>
Firefox:
<input type="checkbox" onclick="toggleFirefox()" style="margin:0;" checked="checked">
<br>
Safari:
<input type="checkbox" onclick="toggleSafari()" style="margin:0;" checked="checked">
</div>
:::

<script>
function toggleMac() { $(".strategy-tool.mac").toggleClass("mac-show");}
function togglePC() { $(".strategy-tool.pc").toggleClass("pc-show");}
function toggleAndroid() { $(".strategy-tool.android").toggleClass("android-show");}
function toggleIOS() { $(".strategy-tool.ios").toggleClass("ios-show");}
function toggleChrome() { $(".strategy-tool.chrome").toggleClass("chrome-show");}
function toggleFirefox() { $(".strategy-tool.firefox").toggleClass("firefox-show");}
function toggleSafari() { $(".strategy-tool.safari").toggleClass("safari-show");}
</script>
:::


<!--
::: {.col-sm-3}
::: {.embed-responsive .embed-responsive-16by9}
<iframe class='embed-responsive-item featured-work-graphic' src='https://www.youtube.com/embed/GCOnzStHQcM' allowfullscreen></iframe>
:::
:::
-->


```{r, results='asis', echo=FALSE}
# function for generating information about detailed tools
generate_strategy_tools <- function(devices, show_classes, title, illustration, description, embed_link){
  cat(str_c('<div class="row strategy-tool ', devices, ' ', show_classes, '">'))
  
  cat('<div class="col-sm-3">')
  cat(str_c('<h5 class="tool-title">', title, '</h5>'))
  cat(str_c('<p class="devices">', devices, '</p>'))
  cat("</div>")
  
  cat('<div class="col-sm-6">')
  cat(str_c("<p>", description, "</p>"))
  cat("</div>")
  
  cat('<div class="col-sm-3">')
  cat(str_c('<img src="', illustration, '" class="img-fluid"/>'))
  #cat('<div class="embed-responsive embed-responsive-16by9">')
  #cat(str_c('<iframe class="embed-responsive-item featured-work-graphic" src="', embed_link, '" allowfullscreen></iframe>'))
  #cat("</div>")
  cat("</div>")
  
  cat("</div>")
}

# function for generating overall types
generate_strategy_types <- function(strategy, illustration, illustration_position, description){
  clean_strategy <- janitor::make_clean_names(strategy)
  
  cat(str_c('<div class="col-sm-3 strategy-type ', clean_strategy, '" onclick="highlightStrategy', clean_strategy, '()" data-toggle="collapse" data-target=".multi-collapse-', clean_strategy, '">'))
  cat("<div class='card'>")
  cat(str_c('<img class="card-img-top" src="', illustration, '" style="object-position: ', illustration_position, ';" alt="Card image cap">'))
  cat("<div class='card-body'>")
  cat(str_c('<h5 class="card-title">', strategy, '</h5>'))
  cat(str_c('<p class="card-text">', description, '</p>'))
  cat(str_c('<button class="btn btn-primary" type="button" data-toggle="collapse" data-target=".multi-collapse-', clean_strategy, '">Tools/instructions</button>'))
  cat(str_c('<div class="arrow ', clean_strategy, '"></div>')) #draw arrow
  cat("</div>")
  cat("</div>")
  cat("</div>")
  
  cat(str_c('<div class="collapse multi-collapse-', clean_strategy, ' strategy-type-tools">'))
  strategies_details %>% 
    filter(actual_strategy == strategy) %>% 
    # a longwinded way of adding -show to classes
    mutate(id = row_number()) %>% 
    mutate(show_classes = str_split(devices, " ")) %>% 
    unnest(cols = c(show_classes)) %>% 
    mutate(show_classes = str_c(show_classes, "-show")) %>% 
    group_by(id) %>% 
    mutate(show_classes = str_c(show_classes, collapse = " ")) %>% 
    distinct() %>% 
    ungroup() %>% 
    select(devices, show_classes, title, illustration, description, embed_link) %>%
    pwalk(generate_strategy_tools)
  cat("</div>")
}

generate_strategy_views <- function(a_strategy_type){
  current_data <- strategy_data %>% 
    filter(category == a_strategy_type) %>% 
    select(strategy, illustration, illustration_position, description)
  
  cat("<div class='row strategy-class'>")
  cat("<div class='col-sm-12'>")
  cat(str_c("<h1>", a_strategy_type, "</h1>"))
  cat("</div>")
  
  pmap(current_data, generate_strategy_types)
  
  # close project row
  cat("</div>")
}

walk(strategy_types, generate_strategy_views)
```


:::
:::


<!-- end strategy page -->
:::


```{r, results='asis'}
generate_highlight_functions <- function(strategy){
  clean_strategy <- janitor::make_clean_names(strategy)
  
  cat(str_c('function highlightStrategy', clean_strategy, '() { $(".strategy-type.', clean_strategy, '").toggleClass("highlight-this"); $(".arrow.', clean_strategy, '").toggleClass("highlight-this");}\n'))
}

cat("<script>")
walk(strategy_data$strategy, generate_highlight_functions)
cat("</script>")
```


<!--
<script>
function highlightStrategyblock_distracting_websites_or_apps() { $(".strategy-type.block_distracting_websites_or_apps").toggleClass("highlight-this");}
</script>
-->

<!-- $(".arrow.', clean_strategy, '").toggleClass("highlight-this");} -->
